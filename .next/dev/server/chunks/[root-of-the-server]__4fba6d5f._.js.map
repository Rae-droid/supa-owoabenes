{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///home/i-m-just-another-guy/Downloads/supa-owoabenes/lib/database/supabase.ts"],"sourcesContent":["import { createClient } from \"@supabase/supabase-js\"\n\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY\nconst supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY\n\nif (!supabaseUrl || !supabaseAnonKey) {\n  console.error(\n    \"[v0] Supabase environment variables are missing! Check NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY in your environment variables.\",\n  )\n}\n\n// Client for browser (use anon key)\nexport const supabaseBrowser = (() => {\n  if (!supabaseUrl || !supabaseAnonKey) {\n    console.warn(\"[v0] Supabase browser client unavailable - missing environment variables\")\n    return null\n  }\n  return createClient(supabaseUrl, supabaseAnonKey)\n})()\n\n// Server client (use service role key - only on server)\nexport const supabaseServer = (() => {\n  if (!supabaseUrl) {\n    console.error(\"[v0] Cannot create Supabase server client - NEXT_PUBLIC_SUPABASE_URL is missing\")\n    return null\n  }\n  const key = supabaseServiceKey || supabaseAnonKey\n  if (!key) {\n    console.error(\"[v0] Cannot create Supabase server client - no valid API key available\")\n    return null\n  }\n  return createClient(supabaseUrl, key)\n})()\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,MAAM;AACN,MAAM;AACN,MAAM,qBAAqB,QAAQ,GAAG,CAAC,yBAAyB;AAEhE;;AAOO,MAAM,kBAAkB,CAAC;IAC9B;;IAIA,OAAO,IAAA,yMAAY,EAAC,aAAa;AACnC,CAAC;AAGM,MAAM,iBAAiB,CAAC;IAC7B;;IAIA,MAAM,MAAM,sBAAsB;IAClC;;IAIA,OAAO,IAAA,yMAAY,EAAC,aAAa;AACnC,CAAC","debugId":null}},
    {"offset": {"line": 76, "column": 0}, "map": {"version":3,"sources":["file:///home/i-m-just-another-guy/Downloads/supa-owoabenes/app/api/products/delete/route.ts"],"sourcesContent":["import { supabaseServer } from \"@/lib/database/supabase\"\nimport { type NextRequest, NextResponse } from \"next/server\"\n\nexport async function POST(request: NextRequest) {\n  console.log(\"DELETE API called\")\n  \n  try {\n    const body = await request.json()\n    console.log(\"Request body received\")\n    \n    if (!supabaseServer) {\n      console.error(\"Supabase not initialized\")\n      return NextResponse.json(\n        { success: false, error: \"Database client not initialized\" },\n        { status: 500 }\n      )\n    }\n\n    const { productId, productData, deletedBy = \"Admin\", reason = \"No reason provided\" } = body\n\n    if (!productId || !productData) {\n      console.error(\"Missing required fields\")\n      return NextResponse.json(\n        { success: false, error: \"Missing required fields: productId and productData\" },\n        { status: 400 }\n      )\n    }\n\n    console.log(\"Attempting to delete from products table...\")\n    \n    // First, delete from products table\n    const { error: deleteError } = await supabaseServer\n      .from(\"products\")\n      .delete()\n      .eq(\"id\", productId)\n\n    console.log(\"Delete from products - error:\", deleteError)\n\n    if (deleteError) {\n      console.error(\"Error deleting from products:\", deleteError)\n      return NextResponse.json(\n        { success: false, error: `Failed to delete from products: ${deleteError.message}` },\n        { status: 500 }\n      )\n    }\n\n    console.log(\"Attempting to insert into deleted_products table...\")\n    \n    // Then, save to deleted_products table\n    const { error: archiveError } = await supabaseServer\n      .from(\"deleted_products\")\n      .insert({\n        product_id: productId,\n        product_name: productData.name || \"Unknown Product\",\n        product_data: productData,\n        deleted_by: deletedBy,\n        reason: reason\n      })\n\n    console.log(\"Insert into deleted_products - error:\", archiveError)\n\n    if (archiveError) {\n      console.error(\"Error archiving to deleted_products:\", archiveError)\n      return NextResponse.json(\n        { success: false, error: `Failed to archive: ${archiveError.message}` },\n        { status: 500 }\n      )\n    }\n\n    console.log(\"Success! Product deleted and archived\")\n    return NextResponse.json({ \n      success: true, \n      message: \"Product deleted and archived successfully\"\n    })\n  } catch (error: any) {\n    console.error(\"[v0] Error in delete product API:\", error)\n    return NextResponse.json(\n      { success: false, error: error.message || \"Unknown error\" },\n      { status: 500 }\n    )\n  }\n}\n\nexport async function GET() {\n  console.log(\"GET deleted products API called\")\n  \n  try {\n    if (!supabaseServer) {\n      return NextResponse.json(\n        { success: false, error: \"Database client not initialized\" },\n        { status: 500 }\n      )\n    }\n\n    const { data, error } = await supabaseServer\n      .from(\"deleted_products\")\n      .select(\"*\")\n      .order(\"deleted_at\", { ascending: false })\n\n    if (error) {\n      console.error(\"Error fetching deleted products:\", error)\n      throw error\n    }\n\n    console.log(\"Fetched deleted products:\", data?.length || 0)\n    return NextResponse.json({ success: true, data: data || [] })\n  } catch (error: any) {\n    console.error(\"[v0] Error fetching deleted products:\", error)\n    return NextResponse.json(\n      { success: false, error: error.message },\n      { status: 500 }\n    )\n  }\n}"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAEO,eAAe,KAAK,OAAoB;IAC7C,QAAQ,GAAG,CAAC;IAEZ,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,QAAQ,GAAG,CAAC;QAEZ,IAAI,CAAC,+IAAc,EAAE;YACnB,QAAQ,KAAK,CAAC;YACd,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,SAAS;gBAAO,OAAO;YAAkC,GAC3D;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,EAAE,SAAS,EAAE,WAAW,EAAE,YAAY,OAAO,EAAE,SAAS,oBAAoB,EAAE,GAAG;QAEvF,IAAI,CAAC,aAAa,CAAC,aAAa;YAC9B,QAAQ,KAAK,CAAC;YACd,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,SAAS;gBAAO,OAAO;YAAqD,GAC9E;gBAAE,QAAQ;YAAI;QAElB;QAEA,QAAQ,GAAG,CAAC;QAEZ,oCAAoC;QACpC,MAAM,EAAE,OAAO,WAAW,EAAE,GAAG,MAAM,+IAAc,CAChD,IAAI,CAAC,YACL,MAAM,GACN,EAAE,CAAC,MAAM;QAEZ,QAAQ,GAAG,CAAC,iCAAiC;QAE7C,IAAI,aAAa;YACf,QAAQ,KAAK,CAAC,iCAAiC;YAC/C,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,SAAS;gBAAO,OAAO,CAAC,gCAAgC,EAAE,YAAY,OAAO,EAAE;YAAC,GAClF;gBAAE,QAAQ;YAAI;QAElB;QAEA,QAAQ,GAAG,CAAC;QAEZ,uCAAuC;QACvC,MAAM,EAAE,OAAO,YAAY,EAAE,GAAG,MAAM,+IAAc,CACjD,IAAI,CAAC,oBACL,MAAM,CAAC;YACN,YAAY;YACZ,cAAc,YAAY,IAAI,IAAI;YAClC,cAAc;YACd,YAAY;YACZ,QAAQ;QACV;QAEF,QAAQ,GAAG,CAAC,yCAAyC;QAErD,IAAI,cAAc;YAChB,QAAQ,KAAK,CAAC,wCAAwC;YACtD,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,SAAS;gBAAO,OAAO,CAAC,mBAAmB,EAAE,aAAa,OAAO,EAAE;YAAC,GACtE;gBAAE,QAAQ;YAAI;QAElB;QAEA,QAAQ,GAAG,CAAC;QACZ,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,SAAS;QACX;IACF,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,qCAAqC;QACnD,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,SAAS;YAAO,OAAO,MAAM,OAAO,IAAI;QAAgB,GAC1D;YAAE,QAAQ;QAAI;IAElB;AACF;AAEO,eAAe;IACpB,QAAQ,GAAG,CAAC;IAEZ,IAAI;QACF,IAAI,CAAC,+IAAc,EAAE;YACnB,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,SAAS;gBAAO,OAAO;YAAkC,GAC3D;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,+IAAc,CACzC,IAAI,CAAC,oBACL,MAAM,CAAC,KACP,KAAK,CAAC,cAAc;YAAE,WAAW;QAAM;QAE1C,IAAI,OAAO;YACT,QAAQ,KAAK,CAAC,oCAAoC;YAClD,MAAM;QACR;QAEA,QAAQ,GAAG,CAAC,6BAA6B,MAAM,UAAU;QACzD,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAM,MAAM,QAAQ,EAAE;QAAC;IAC7D,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,yCAAyC;QACvD,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,SAAS;YAAO,OAAO,MAAM,OAAO;QAAC,GACvC;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}